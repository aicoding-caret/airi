# 🧪 TDD 기반 한국어 번역 개발 워크플로우

## 🎯 TDD 원칙 적용

### **기본 개념**
**Test First → Code → Refactor** 사이클을 번역 작업에 적용:
1. **번역 요구사항 정의** (Test)
2. **번역 작업 수행** (Code)
3. **품질 검증 및 개선** (Refactor)

## 🔄 개발 사이클

### **Red → Green → Refactor**

#### **🔴 Red Phase: 실패하는 테스트 작성**
```bash
# 1. 번역 키 누락 체크
pnpm typecheck  # 실패해야 함 (아직 번역 안됨)

# 2. UI 테스트 (예상 실패)
pnpm dev  # 한국어 선택했을 때 영어로 나와야 함

# 3. 빌드 테스트 (예상 실패)
pnpm build  # i18n 키 누락으로 경고/오류
```

#### **🟢 Green Phase: 최소한의 번역으로 테스트 통과**
```bash
# 1. 핵심 키들만 번역해서 타입체크 통과시키기
# 2. UI에서 한국어가 표시되게 하기
# 3. 빌드 성공시키기
```

#### **🔵 Blue Phase: 번역 품질 개선 및 리팩토링**
```bash
# 1. 번역 품질 향상
# 2. 용어 일관성 체크
# 3. UI 레이아웃 확인
```

## 🤖 자동화된 테스트 전략

### **Level 1: 구문 검증 (자동)**
```bash
# YAML 구문 검증
pnpm typecheck

# ESLint 검사
pnpm lint

# 빌드 테스트
pnpm build
```
**→ 실패시 수동 확인 불필요, 바로 수정**

### **Level 2: 키 완전성 검증 (자동)**
```bash
# 번역 키 누락 체크 스크립트 (생성 예정)
pnpm check:i18n-keys

# 예상 결과:
# ✅ base.yaml: 100% (3/3 keys)
# ❌ settings.yaml: 15% (127/834 keys) - 누락 707개
# ✅ stage.yaml: 100% (12/12 keys)
```

### **Level 3: 기능 검증 (반자동)**
```bash
# 개발 서버 자동 시작
pnpm dev

# 자동 브라우저 열기 스크립트 (생성 예정)
start http://localhost:5174
```

**→ 브라우저에서 간단한 체크리스트만 수행**

## 📋 통합 테스트 체크리스트 (최소화)

### **🎯 당신이 확인해야 할 것만**

#### **1. 언어 전환 테스트 (2분)**
- [ ] 설정 → 언어 → 한국어 선택 가능
- [ ] 언어 변경 후 새로고침해도 한국어 유지
- [ ] 다시 영어로 전환 가능

#### **2. 핵심 UI 테스트 (3분)**
- [ ] 메인 채팅 화면이 한국어로 표시
- [ ] "무언가 말해보세요..." 플레이스홀더 확인
- [ ] 설정 버튼/메뉴가 한국어로 표시
- [ ] 모델 로딩 상태 메시지가 한국어로 표시

#### **3. 설정 화면 테스트 (5분)**
- [ ] 설정 → AIRI 카드 메뉴가 한국어
- [ ] 설정 → 제공업체 메뉴가 한국어
- [ ] 설정 → 모듈 메뉴가 한국어
- [ ] 온보딩 다이얼로그가 한국어 (첫 실행시)

#### **4. 레이아웃 깨짐 확인 (2분)**
- [ ] 긴 한국어 텍스트로 버튼이 깨지지 않음
- [ ] 모바일 화면에서도 레이아웃 정상
- [ ] 폰트가 정상적으로 로드됨

#### **5. 데스크톱 앱 테스트 (3분)** - *선택사항*
```bash
pnpm dev:tamagotchi  # 자동 실행
```
- [ ] 데스크톱 앱에서도 한국어 정상 표시
- [ ] 시스템 트레이 메뉴 한국어

**총 소요시간: 약 15분**

## ⚡ 자동화 도구 생성 계획

### **1. 번역 키 체크 스크립트**
```typescript
// scripts/check-i18n-keys.ts
// - 영어 원본과 한국어 번역의 키 비교
// - 누락된 키 리스트 출력
// - 번역 완료율 표시
```

### **2. 자동 테스트 스크립트**
```bash
# scripts/test-korean.sh
#!/bin/bash
echo "🧪 한국어 번역 TDD 테스트 시작..."

echo "1️⃣ 구문 검증 중..."
pnpm typecheck || exit 1
pnpm lint || exit 1

echo "2️⃣ 번역 키 검증 중..."
pnpm check:i18n-keys

echo "3️⃣ 빌드 테스트 중..."
pnpm build || exit 1

echo "4️⃣ 개발 서버 시작 중..."
pnpm dev &
SERVER_PID=$!

echo "✅ 자동 테스트 완료! 브라우저 테스트를 진행하세요."
echo "🌐 http://localhost:5174"
echo "⏹️  테스트 완료 후 Ctrl+C로 서버 중단"

wait $SERVER_PID
```

### **3. 빠른 수동 테스트 가이드 HTML**
```html
<!-- test-checklist.html -->
<!-- 브라우저에서 열어서 체크리스트로 사용 -->
<h2>🇰🇷 한국어 번역 테스트</h2>
<ul>
  <li><input type="checkbox"> 언어 선택에서 한국어 옵션 확인</li>
  <li><input type="checkbox"> 메인 UI 한국어 표시 확인</li>
  <!-- ... -->
</ul>
```

## 📊 품질 메트릭

### **자동 측정 가능한 지표**
- ✅ 번역 완료율: `완료 키 / 전체 키 × 100%`
- ✅ 타입체크 통과율: `100%` (통과) 또는 `실패`
- ✅ 빌드 성공률: `100%` (성공) 또는 `실패`
- ✅ 린트 오류 수: `0개` 목표

### **수동 확인 필요한 지표**
- 🔍 UI 레이아웃 정합성: 5점 척도
- 🔍 번역 자연스러움: 5점 척도
- 🔍 용어 일관성: 5점 척도

## 🎯 단계별 TDD 적용

### **Phase 1: 기본 구조 (Red-Green-Refactor)**

#### **Red**: 빈 파일들로 테스트 실패 만들기
```bash
# 빈 YAML 파일들 생성
touch packages/i18n/src/locales/ko/{base,stage,settings}.yaml

# 예상: 타입체크 실패, 빌드 실패
pnpm typecheck  # ❌ 실패
pnpm build      # ❌ 실패
```

#### **Green**: 최소한의 내용으로 통과시키기
```yaml
# 각 파일에 최소한의 더미 키들만 추가
test: '테스트'
```

#### **Refactor**: 실제 번역 내용으로 개선
```yaml
# 제대로 된 번역 내용으로 교체
```

### **Phase 2: 점진적 확장**
각 설정 섹션을 하나씩 Red-Green-Refactor로 진행

### **Phase 3: 통합 테스트**
전체 시스템이 한국어로 동작하는지 확인

## 🚀 실행 명령어 요약

```bash
# 🔴 Red: 실패 상태 확인
pnpm test:korean:red

# 🟢 Green: 최소 구현으로 통과
pnpm test:korean:green

# 🔵 Refactor: 품질 개선 후 재검증
pnpm test:korean:refactor

# ⚡ 전체 자동 테스트
pnpm test:korean

# 👀 수동 테스트 시작 (브라우저 자동 열기)
pnpm test:korean:manual
```

## 💡 이점

### **개발자에게**
- ✅ **명확한 진척도**: 테스트 통과율로 진행 상황 파악
- ✅ **조기 오류 발견**: 타입 오류, 구문 오류를 바로 감지
- ✅ **자신감 있는 리팩토링**: 테스트가 있어서 개선 작업 안전

### **테스터에게**
- ✅ **최소한의 수동 테스트**: 자동화로 대부분 검증 완료
- ✅ **구조적 테스트**: 체크리스트 기반으로 누락 없이
- ✅ **빠른 피드백**: 15분 이내 전체 기능 검증

### **프로젝트에게**
- ✅ **높은 품질**: 체계적 검증으로 버그 최소화
- ✅ **유지보수성**: 향후 번역 업데이트 시에도 동일한 프로세스 적용
- ✅ **확장성**: 다른 언어 번역에도 동일한 방식 적용 가능

---

**결론**: TDD 접근으로 번역 작업의 품질을 보장하면서도 수동 테스트 부담을 최소화할 수 있습니다!
